<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="Jellybean Vending Machine">
    <meta name="author" content="Elaine Ou">

    <title>beans for bits</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
 
    <!-- Custom Google Web Font -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Arvo:400,700' rel='stylesheet' type='text/css'>
	
    <!-- Custom CSS-->
    <link href="css/general.css" rel="stylesheet">
	
	 <!-- Owl-Carousel -->
    <link href="css/custom.css" rel="stylesheet">
	<link href="css/owl.carousel.css" rel="stylesheet">
    <link href="css/owl.theme.css" rel="stylesheet">
	<link href="css/style.css" rel="stylesheet">
	<link href="css/animate.css" rel="stylesheet">
	
	<!-- Magnific Popup core CSS file -->
	<link rel="stylesheet" href="css/magnific-popup.css"> 
	
	<script src="js/modernizr-2.6.2.min.js"></script>  <!-- Modernizr /-->
</head>

<body id="home">

	<!-- Preloader -->
	<div id="preloader">
		<div id="status"></div>
	</div>
	
	<!-- FullScreen -->
    <div class="intro-header">
		<div class="col-xs-12 text-center abcen1">
			<h1 class="h1_home wow fadeIn" data-wow-delay="0.4s">beans for bits</h1>
			<h3 class="h3_home wow fadeIn" data-wow-delay="0.6s">Trust-Minimized Jellybean Management</h3>
			<ul class="list-inline intro-social-buttons">
				<li><a href="#buybeans" class="btn  btn-lg mybutton_standard wow swing wow fadeIn" data-wow-delay="1.2s"><span class="network-name">Buy Some Beans</span></a>
				</li>
        <li><a href="#viewdemo" class="btn  btn-lg mybutton_cyano wow swing wow fadeIn" data-wow-delay="1.2s"><span class="network-name">View Demo</span></a>
        </li>
			</ul>
		</div>    
        <!-- /.container -->
		<div class="col-xs-12 text-center abcen wow fadeIn">
			<div class="button_down "> 
				<a class="imgcircle wow bounceInUp" data-wow-duration="1.5s"  href="#whatis"> <img class="img_scroll" src="img/icon/circle.png" alt=""> </a>
			</div>
		</div>
    </div>
	
	<!-- NavBar-->
	<nav class="navbar-default" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#home">beans for bits</a>
			</div>

			<div class="collapse navbar-collapse navbar-right navbar-ex1-collapse">
				<ul class="nav navbar-nav">
					
					<li class="menuItem"><a href="#whatis">What is this?</a></li>
					<li class="menuItem"><a href="#buybeans">Buy Beans</a></li>
					<li class="menuItem"><a href="#contact">Delivery</a></li>
				</ul>
			</div>
		   
		</div>
	</nav> 
	
	<!-- What is -->
	<div id="whatis" class="content-section-b" style="border-top: 0">
		<div class="container">

			<div class="col-md-6 col-md-offset-3 text-center wrap_title">
				<h2>What is this?</h2>
				<p class="lead"><span style="color:#381c66"><b>beans for bits</b></span> is a an ownership-aware device that controls real-world assets using digital protocols. In other words, a vending machine.<br> It was inspired by the idea of <span style="color:#381c66"><b><a href="http://szabo.best.vwh.net/proplets.html">proplets</a></b></span>.
                </p>
				
			</div>
            <div class="row">
                <div class="col-md-10 col-md-offset-1">
                <img src="img/vending.jpg" style="width:100%">
                </div>
            </div>
			<div class="row">
				<div class="col-sm-12 wow fadeInDown ">
				<p class="lead"><span style="color:#381c66"><b>beans for bits</b></span> is controlled by a lightning node. The design was adapted from a <a href="https://medium.com/@eiaine/selling-real-world-goods-with-a-21-bitcoin-computer-c413ffe8376c" target="_blank">21-computer vending machine</a> built for Abra many years ago.</p>
				</div>
			</div>
            <div class="row">
                <div class="col-sm-12 wow fadeInDown ">
                <h3>How do I get my beans?</h3>
                <p class="lead">Jellybeans are dispensed from the vending machine at <a href="https://www.goabra.com/">Abra's office</a> in Mountain View, California. <br>Non-employees are welcome to purchase beans to feed the engineers, like at the zoo.</p>
                <h4><a style="color:#381c66" href="http://elaineou.com/2016/02/11/trust-minimized-property-control-with-jellybeans-and-ethereum/" target="_blank">Instructions on how to build your own Lightning-powered vending machine...</a></h4>
                <center><img  class="rotate" src="img/jellybean.png" style="max-width:100px"></center>
                </div>
            </div>

		
		</div>
	</div>
	
	
	<div id="buybeans" class="content-section-c ">
		<div class="container">
			<div class="row">
			<div class="col-md-8 col-md-offset-2 text-center white">
				<h2>Buy some Beans</h2>
			 </div>
			 </div>
			 <div class="row">
			 <div class="bean-form">
				 <form>
          <input id="bean-rhash" type="hidden">
					<input id="bean-count" type="number" onchange="updatePrice()" min="1" placeholder="number of beans" onkeyup="this.onchange();" onpaste="this.onchange();" oninput="this.onchange();"/> x 50,000 Satoshis per bean = 
					<input id="bean-price" type="text" disabled/>
				</form>
			</div>
			<div id="qr-mock" class="mockup-content">
					<div class="morph-button wow pulse morph-button-inflow morph-button-inflow-1">
						<button type="button " id="bean-button"><span>Pay with Lightning</span></button>
						<div class="morph-content">
							<div>
								<div class="content-style-form content-style-form-4 ">
									<h2 class="morph-clone">Pay with Lightning</h2>
									<form>
                      <div id="bean-total">1 BTC<br></div>
                      <div id="qrcode" ><img src="https://chart.googleapis.com/chart?chs=200x200&cht=qr&chld=M|0&chl='bitcoin:1ELaiNeQk4rpAL2dUYJ9MSm4dzwo7xG4E5?amount=10000"></div>
                      <code id="payreq" ></code>
                      <a id="bean-checkout" class="btn btn-info">Pay with Lightning</a>
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>	
		</div>
	</div>	
	
	<!-- Contact -->
	<div id="contact" class="content-section-a">
		<div class="container">
			<div class="row">
			
			<div class="col-md-6 col-md-offset-3 text-center wrap_title">
				<h2>Delivery</h2>
				<p class="lead" >...is not yet available. If you are not at the Mountain View office to accept your purchase, your beans will be delivered to the kitchen floor.</p>
				<img  class="rotate" src="img/jellybean.png" style="max-width:100px">
			</div>
			
			</div>
		</div>
	</div>
    <div id="viewdemo" class="content-section-b">
        <div class="container">
            <div class="row">
            
            <div class="col-md-6 col-md-offset-3 text-center wrap_title">
                <h2>View Demo</h2>
                <p class="lead" >Here is an example of a lightning-powered vending machine in action. (insert video)</p>
            </div>            
            </div>
              
            </div>
        </div>
    </div>
	
	
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-md-12 text-center">
            <a href="https://github.com/elaineo/Jellybean" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" style="fill: #a6a6a6"/></svg></a>&nbsp; &nbsp;
            <a href="https://twitter.com/eiaine" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z" style="fill: #a6a6a6"/></svg></a>&nbsp; &nbsp;
            <a href="https://elaineou.com" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M21 13v10h-6v-6h-6v6h-6v-10h-3l12-12 12 12h-3zm-1-5.907v-5.093h-3v2.093l3 3z" style="fill: #a6a6a6"/></svg></a>
			<br>
          </div> <!-- /col-xs-7 -->
        </div>
      </div>
    </footer>

    <div id="confirmModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <center><img  class="rotate" src="img/jellybean.png" style="max-width:60px"><br>
                  <h4>Payment Received!</h4></center>
            </div>
            <div class="modal-body">
              <p>
                <b>Date: </b> <span style="margin-left:5em" id="confDate"></span><br>
                <b>Order Summary: </b> <span id="confOrder"></span><br>
                <b>Total: </b> <span style="margin-left:5em" id="confPrice"></span> satoshis
              </p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-info" data-dismiss="modal">Hooray</button>
            </div>
          </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/bootstrap.js"></script>
	<script src="js/owl.carousel.js"></script>
	<script src="js/script.js"></script>
	<!-- StikyMenu -->
	<script src="js/stickUp.min.js"></script>
	<script type="text/javascript">
	  jQuery(function($) {
		$(document).ready( function() {
		  $('.navbar-default').stickUp();		  
		});
	  });
	
	</script>
	<!-- Smoothscroll -->
	<script type="text/javascript" src="js/jquery.corner.js"></script> 
	<script src="js/wow.min.js"></script>
	
	<script>
    var BEAN_PRICE = 50000;

    $(document).ready(function() {
      $("#bean-button").prop("disabled", true);
    });
    function updatePrice() {
        var qty = $("#bean-count").val();
        if (qty!="") $("#bean-button").prop("disabled", false);
        var price = qty / 2000;
        $("#bean-price").val(price + " BTC");

        var address = $("#bean-address").val();
          qty = price * 100000000;
          var price = $("#bean-price").val();
          var btcHTML = '<p>'+ price + '<br>Your beans will be dispensed as soon as payment is confirmed.<\/p>';
          $('#bean-total').html(btcHTML);
    }

    $("#bean-button").click(function(e) {
        e.preventDefault();
        var qty = $("#bean-count").val();
        var price = qty * BEAN_PRICE;
        $.ajax({
            type: "POST",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({'qty': qty, 'price': price}),
            url: '/invoice',
            success: function(response) {
              console.log(response);
              $("#payreq").text(response.invoice);
              var lntb = "lightning:" + response.invoice;
              var lnHTML = '<center><img src="https://chart.googleapis.com/chart?chs=200x200&cht=qr&chld=M|0&chl=' + lntb + '"></center>';
              $('#qrcode').html(lnHTML);
              $('#bean-checkout').attr('href', lntb);
              var lnSocket = new WebSocket("ws://localhost:8080/lnsocket?r_hash=" + 
                encodeURIComponent(response.r_hash));
              $('#bean-rhash').val(response.r_hash);
              lnSocket.onmessage = function (event) {
                console.log(event.data);
                var data = JSON.parse(event.data);
                if (data.settle_date) {
                  $("span#confPrice").html(data.value);
                  $("span#confOrder").html(data.memo);
                  $("span#confDate").html(new Date(data.settle_date*1000));
                  $("#confirmModal").modal("show");
                  $('#bean-total').html("Payment Received!");
                }
              }
            }
        });
    })
  </script>
	<script src="js/classie.js"></script>
	<script src="js/uiMorphingButton_inflow.js"></script>
	<!-- Magnific Popup core JS file -->
	<script src="js/jquery.magnific-popup.js"></script> 
</body>

</html>
